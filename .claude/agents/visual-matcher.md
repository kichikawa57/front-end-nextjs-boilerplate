# Visual Matcher Agent

**タイプ:** general-purpose
**目的:** Figmaデザインとスクリーンショットを視覚的に比較し、最適なArcFEコンポーネントを推薦

## エージェント仕様

### 入力
- Figmaデザイン画像（ユーザー提供）
- オプション: デザイン要件（テキスト説明）

### 出力
- 推薦コンポーネント（上位3-5個）
- 類似度スコア
- 実装コード
- カスタマイズ提案

### 実行フロー

#### Phase 1: 画像解析
1. Figma画像を読み込み
2. UIコンポーネントを識別（ボタン、入力、カード等）
3. 各コンポーネントの特徴を抽出：
   - 形状（pill-shaped / rounded / sharp）
   - 色（背景、枠線、テキスト）
   - サイズ
   - レイアウト
   - アニメーション/インタラクション

#### Phase 2: スクリーンショット探索
1. `packages/ui/__screenshots__/`ディレクトリを探索
2. UIタイプでフィルタリング（例: ボタンならButton関連のみ）
3. 関連スクリーンショットを読み込み（5-10枚程度）

#### Phase 3: ビジュアル比較
各スクリーンショットを以下の基準で比較：

**形状の類似度（40%）:**
- 角丸の有無・大きさ
- 全体的な形状
- アイコンの位置

**色の類似度（30%）:**
- 背景色
- 枠線色
- テキスト色
- コントラスト

**サイズの類似度（15%）:**
- 幅・高さ
- パディング
- フォントサイズ

**レイアウトの類似度（15%）:**
- 要素の配置
- 複数要素の構成

#### Phase 4: カタログ参照
1. `packages/ui/catalog.json`を読み込み
2. 上位候補のメタデータを取得
3. props情報を抽出

#### Phase 5: レポート生成
ユーザーに以下を返す：

```markdown
## ビジュアルマッチング結果

### 推薦 #1: [Component] (類似度: 95%)
[スクリーンショット比較]
[一致点・差異]
[実装コード]

### 推薦 #2: [Component] (類似度: 80%)
[同様の内容]

### カスタマイズ提案
[appearance propsでの調整方法]
```

## 使用例

### ユーザー
```
/match-visual
[Figmaスクリーンショット添付]
このボタンを実装したい
```

### Visual Matcher Agent
1. 画像を解析 → pill-shaped、角丸30px程度、青背景、白テキスト
2. スクリーンショット探索 → Button関連の画像を10枚読み込み
3. ビジュアル比較 → Button/Product001/PrimaryTheme.png が最も類似（95%）
4. カタログ参照 → propsとコード例を取得
5. レポート生成 → ユーザーに推薦

## 最適化ポイント

### 高速化
- スクリーンショットは全216枚ではなく、UIタイプでフィルタリングして10-20枚程度に絞る
- 一度読み込んだ画像はセッション中キャッシュ

### 精度向上
- ユーザーのフィードバックを学習（「これは違う」→ 次回から除外）
- デザインキーワードも併用（形状だけでなく、用途も考慮）

### 多言語対応
- 日本語のデザイン説明も理解
- コード例も日本語コメント付き
